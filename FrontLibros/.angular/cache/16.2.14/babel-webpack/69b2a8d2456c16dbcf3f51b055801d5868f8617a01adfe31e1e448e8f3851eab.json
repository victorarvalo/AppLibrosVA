{"ast":null,"code":"import { FormControl, FormGroup } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/Storage/Sesion-Storage.Service\";\nimport * as i3 from \"src/app/Library/Services/resena.service.service\";\nimport * as i4 from \"@angular/forms\";\nconst _c0 = [\"class\", \"resena\"];\nexport let CreateResenaComponent = /*#__PURE__*/(() => {\n  class CreateResenaComponent {\n    constructor(route, _sessionStorageService, _resenaServiceService) {\n      this.route = route;\n      this._sessionStorageService = _sessionStorageService;\n      this._resenaServiceService = _resenaServiceService;\n      this.aspNetUserNav = '';\n      this.bookLocal = JSON.parse(JSON.stringify(this.route.getCurrentNavigation()?.extras.state)).book;\n      this.formulario = new FormGroup({\n        calificacionresena: new FormControl(),\n        descripcionresena: new FormControl()\n      });\n    }\n    ngOnInit() {\n      const lenghtSession = this._sessionStorageService.length;\n      if (lenghtSession > 0) {\n        const firstKey = this._sessionStorageService.key(0);\n        const emailUser = this._sessionStorageService.getItem(firstKey);\n        this.aspNetUserNav = emailUser !== null ? emailUser : '';\n      } else {\n        this.aspNetUserNav = '';\n      }\n    }\n    createResena() {\n      let resena = {\n        \"idlibro\": 0,\n        \"calificacionresena\": 0,\n        \"descripcionresena\": '',\n        \"fecharesena\": '',\n        \"aspnetuser\": ''\n      };\n      const dataform = this.formulario.value;\n      resena.idlibro = this.bookLocal.idlibro;\n      resena.calificacionresena = Number(dataform.calificacionresena);\n      resena.descripcionresena = dataform.descripcionresena;\n      resena.aspnetuser = this.aspNetUserNav;\n      resena.fecharesena = this.getDateFormat();\n      console.log(\"reseña: \" + JSON.stringify(resena));\n      this._resenaServiceService.postCreateResenas(resena).subscribe(data => {\n        console.log(\"Reseña creada exitosamente!!\");\n      }, error => {\n        console.log(error);\n      });\n      this.route.navigateByUrl('bookdetails', {\n        state: {\n          book: this.bookLocal\n        }\n      });\n    }\n    getDateFormat() {\n      const timeElapsed = Date.now();\n      const today = new Date(timeElapsed);\n      let mount, days;\n      if (today.getMonth() < 10) {\n        mount = `0${today.getUTCMonth()}`;\n      } else {\n        mount = `${today.getUTCMonth()}`;\n      }\n      if (today.getDay() < 10) {\n        days = `0${today.getUTCDay()}`;\n      } else {\n        days = `${today.getUTCDate()}`;\n      }\n      return `${today.getUTCFullYear()}-${mount}-${days}`;\n    }\n    static #_ = this.ɵfac = function CreateResenaComponent_Factory(t) {\n      return new (t || CreateResenaComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.SessionStorageService), i0.ɵɵdirectiveInject(i3.ResenaServiceService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CreateResenaComponent,\n      selectors: [[\"app-create\", 8, \"resena\"]],\n      attrs: _c0,\n      decls: 37,\n      vars: 6,\n      consts: [[1, \"container\", 2, \"width\", \"80%\", \"border-color\", \"blue\", \"border\", \"10px\"], [1, \"d-flex\", \"justify-content-center\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"mb-3\"], [\"type\", \"text\", \"formControlName\", \"descripcionresena\", 1, \"form-control\"], [\"type\", \"number\", \"formControlName\", \"calificacionresena\", \"placeholder\", \"1 a 5\", 1, \"form-control\"], [\"type\", \"submit\", 1, \"btn\", \"btn-outline-primary\"]],\n      template: function CreateResenaComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\", 1)(4, \"label\");\n          i0.ɵɵtext(5, \"Titulo: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"label\");\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 1)(9, \"label\");\n          i0.ɵɵtext(10, \"Autor: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"label\");\n          i0.ɵɵtext(12);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(13, \"div\", 1)(14, \"label\");\n          i0.ɵɵtext(15, \"Categoria: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"label\");\n          i0.ɵɵtext(17);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(18, \"div\", 0)(19, \"form\", 2);\n          i0.ɵɵlistener(\"ngSubmit\", function CreateResenaComponent_Template_form_ngSubmit_19_listener() {\n            return ctx.createResena();\n          });\n          i0.ɵɵelementStart(20, \"div\", 3)(21, \"label\");\n          i0.ɵɵtext(22, \"Descripci\\u00F3n:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(23, \"br\")(24, \"input\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"div\", 3)(26, \"label\");\n          i0.ɵɵtext(27, \"Calificaci\\u00F3n:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(28, \"br\")(29, \"input\", 5);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(30, \"div\", 3)(31, \"label\");\n          i0.ɵɵtext(32, \"Usuario:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(33, \"br\");\n          i0.ɵɵelementStart(34, \"label\");\n          i0.ɵɵtext(35);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(36, \"input\", 6);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\"Crear Rese\\u00F1a para \", ctx.bookLocal.titulolibro, \"\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate1(\" \", ctx.bookLocal.titulolibro, \"\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate1(\" \", ctx.bookLocal.autorlibro, \"\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate(ctx.bookLocal.idcategoriaNavigation.nombrecategoria);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.formulario);\n          i0.ɵɵadvance(16);\n          i0.ɵɵtextInterpolate(ctx.aspNetUserNav);\n        }\n      },\n      dependencies: [i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName]\n    });\n  }\n  return CreateResenaComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}